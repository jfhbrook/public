\documentclass[10pt]{article}
\usepackage{amsmath,amssymb}
\usepackage{hevea}
\begin{document}
\title{Gradients Used in the Jacobian: A Supplement}
\author{Joshua Holbrook}
\section*{Gradients Used in the Jacobian}

These aren't very enlightening, but they're included for the sake of completeness.  There are no guarantees that these are the same as the ones I actually used, since I had to process them heavily from the python versions and I'm not very good at automated replacing.

\[v=\begin{pmatrix}r_1\\r_2\\r_3\\r_4\\\theta_1\\h_x\\h_y\\O_x\\O_y\end{pmatrix}\]

\[\bigtriangledown_v\tilde{S}_x=\left(\begin{array}{l}
h_x(-2r_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(-2r_4\sin(\theta_1) + \sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}({-0.5}(4r_1 - 4r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) + 2r_4(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))\cos(\theta_1) + 2r_4(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))\sin(\theta_1))) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(-2r_1 + 2r_4\cos(\theta_1) + 2r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))\sin(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))) + \cos(\theta_1)) + h_y(-\sin(\theta_1) - 2r_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(-2r_4\sin(\theta_1) + \sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}({-0.5}(4r_1 - 4r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) + 2r_4(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))\cos(\theta_1) + 2r_4(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))\sin(\theta_1))) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(-2r_1 + 2r_4\cos(\theta_1) + 2r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))\cos(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))))\\
h_y(-2r_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(2r_4\sin((\theta_2)_j) + \sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}({-0.5}(4r_2 - 4r_1\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) - 2r_4(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))\cos((\theta_2)_j) - 2r_4(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))\sin((\theta_2)_j))) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(-2r_2 - 2r_4\cos((\theta_2)_j) + 2r_1\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))\cos(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))) + \sin((\theta_2)_j)) + (1 - h_x)\cos((\theta_2)_j) - 2h_xr_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(2r_4\sin((\theta_2)_j) + \sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}({-0.5}(4r_2 - 4r_1\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) - 2r_4(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))\cos((\theta_2)_j) - 2r_4(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))\sin((\theta_2)_j))) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(-2r_2 - 2r_4\cos((\theta_2)_j) + 2r_1\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))\sin(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))))\\ 
-2h_xr_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(2r_3(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)) + 2r_3\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)))\sin(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))) - 2h_yr_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(2r_3(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)) + 2r_3\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)))\cos(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))) \\
h_x(-2r_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(-2r_1\sin(\theta_1) + 2r_2\sin((\theta_2)_j) + \sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}(-2r_4(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) + {0.5}(-4r_2\cos((\theta_2)_j) + 4r_1\cos(\theta_1))(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1)) + {0.5}(-4r_2\sin((\theta_2)_j) + 4r_1\sin(\theta_1))(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1)))) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(-2r_4 - 2r_2\cos((\theta_2)_j) + 2r_1\cos(\theta_1))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))\sin(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))) + \cos(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))))) + h_y(-\sin(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))) - 2r_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(-2r_1\sin(\theta_1) + 2r_2\sin((\theta_2)_j) + \sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}(-2r_4(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) + {0.5}(-4r_2\cos((\theta_2)_j) + 4r_1\cos(\theta_1))(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1)) + {0.5}(-4r_2\sin((\theta_2)_j) + 4r_1\sin(\theta_1))(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1)))) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(-2r_4 - 2r_2\cos((\theta_2)_j) + 2r_1\cos(\theta_1))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))\cos(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))))) \\
h_x(-r_1\sin(\theta_1) - 2r_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}({-0.5}(-4r_1r_2\cos(\theta_1)^2\cos((\theta_2)_j)\sin((\theta_2)_j) + 4r_1r_2\sin(\theta_1)^2\cos((\theta_2)_j)\sin((\theta_2)_j))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) - 2r_1r_4(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))\sin(\theta_1) + 2r_1r_4(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))\cos(\theta_1)) - 2r_1r_4\cos(\theta_1)) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))(-2r_1r_4\sin(\theta_1) - 2r_1r_2\sin(\theta_1)^2\cos((\theta_2)_j)\sin((\theta_2)_j) + 2r_1r_2\cos(\theta_1)^2\cos((\theta_2)_j)\sin((\theta_2)_j)))\sin(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))))) + h_y(-r_1\cos(\theta_1) - 2r_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}({-0.5}(-4r_1r_2\cos(\theta_1)^2\cos((\theta_2)_j)\sin((\theta_2)_j) + 4r_1r_2\sin(\theta_1)^2\cos((\theta_2)_j)\sin((\theta_2)_j))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) - 2r_1r_4(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))\sin(\theta_1) + 2r_1r_4(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))\cos(\theta_1)) - 2r_1r_4\cos(\theta_1)) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))(-2r_1r_4\sin(\theta_1) - 2r_1r_2\sin(\theta_1)^2\cos((\theta_2)_j)\sin((\theta_2)_j) + 2r_1r_2\cos(\theta_1)^2\cos((\theta_2)_j)\sin((\theta_2)_j)))\cos(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))))) \\
r_1\cos(\theta_1) + r_4\cos(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))) - r_2\cos((\theta_2)_j) \\
r_2\sin((\theta_2)_j) - r_1\sin(\theta_1) - r_4\sin(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))))\\
1 \\
0
\end{array}\right)\]

\[\bigtriangledown_v\tilde{S}_y=\left(\begin{array}{l}
h_x(2r_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(-2r_4\sin(\theta_1) + \sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}({-0.5}(4r_1 - 4r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) + 2r_4(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))\cos(\theta_1) + 2r_4(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))\sin(\theta_1))) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(-2r_1 + 2r_4\cos(\theta_1) + 2r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))\cos(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))) + \sin(\theta_1)) + h_y(-\cos(\theta_1) + 2r_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(-2r_4\sin(\theta_1) + \sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}({-0.5}(4r_1 - 4r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) + 2r_4(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))\cos(\theta_1) + 2r_4(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))\sin(\theta_1))) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(-2r_1 + 2r_4\cos(\theta_1) + 2r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))\sin(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))))\\ 
h_y(2r_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(2r_4\sin((\theta_2)_j) + \sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}({-0.5}(4r_2 - 4r_1\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) - 2r_4(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))\cos((\theta_2)_j) - 2r_4(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))\sin((\theta_2)_j))) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(-2r_2 - 2r_4\cos((\theta_2)_j) + 2r_1\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))\sin(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))) + \cos((\theta_2)_j)) + (1 - h_x)\sin((\theta_2)_j) + 2h_xr_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(2r_4\sin((\theta_2)_j) + \sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}({-0.5}(4r_2 - 4r_1\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) - 2r_4(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))\cos((\theta_2)_j) - 2r_4(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))\sin((\theta_2)_j))) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(-2r_2 - 2r_4\cos((\theta_2)_j) + 2r_1\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))\cos(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))) \\
2h_xr_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(2r_3(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)) + 2r_3\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)))\cos(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))) + 2h_yr_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(2r_3(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)) + 2r_3\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)))\sin(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))) \\
h_x(2r_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(-2r_1\sin(\theta_1) + 2r_2\sin((\theta_2)_j) + \sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}(-2r_4(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) + {0.5}(-4r_2\cos((\theta_2)_j) + 4r_1\cos(\theta_1))(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1)) + {0.5}(-4r_2\sin((\theta_2)_j) + 4r_1\sin(\theta_1))(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1)))) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(-2r_4 - 2r_2\cos((\theta_2)_j) + 2r_1\cos(\theta_1))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))\cos(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))) + \sin(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))))) + h_y(-\cos(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))) + 2r_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(-2r_1\sin(\theta_1) + 2r_2\sin((\theta_2)_j) + \sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}(-2r_4(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) + {0.5}(-4r_2\cos((\theta_2)_j) + 4r_1\cos(\theta_1))(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1)) + {0.5}(-4r_2\sin((\theta_2)_j) + 4r_1\sin(\theta_1))(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1)))) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(-2r_4 - 2r_2\cos((\theta_2)_j) + 2r_1\cos(\theta_1))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))\sin(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))))) \\
h_x(r_1\cos(\theta_1) + 2r_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}({-0.5}(-4r_1r_2\cos(\theta_1)^2\cos((\theta_2)_j)\sin((\theta_2)_j) + 4r_1r_2\sin(\theta_1)^2\cos((\theta_2)_j)\sin((\theta_2)_j))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) - 2r_1r_4(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))\sin(\theta_1) + 2r_1r_4(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))\cos(\theta_1)) - 2r_1r_4\cos(\theta_1)) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))(-2r_1r_4\sin(\theta_1) - 2r_1r_2\sin(\theta_1)^2\cos((\theta_2)_j)\sin((\theta_2)_j) + 2r_1r_2\cos(\theta_1)^2\cos((\theta_2)_j)\sin((\theta_2)_j)))\cos(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))))) + h_y(r_1\sin(\theta_1) + 2r_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}({-0.5}(-4r_1r_2\cos(\theta_1)^2\cos((\theta_2)_j)\sin((\theta_2)_j) + 4r_1r_2\sin(\theta_1)^2\cos((\theta_2)_j)\sin((\theta_2)_j))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) - 2r_1r_4(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))\sin(\theta_1) + 2r_1r_4(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))\cos(\theta_1)) - 2r_1r_4\cos(\theta_1)) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))(-2r_1r_4\sin(\theta_1) - 2r_1r_2\sin(\theta_1)^2\cos((\theta_2)_j)\sin((\theta_2)_j) + 2r_1r_2\cos(\theta_1)^2\cos((\theta_2)_j)\sin((\theta_2)_j)))\sin(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))))) \\
r_1\sin(\theta_1) + r_4\sin(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j)))) - r_2\sin((\theta_2)_j) \\
r_2\cos((\theta_2)_j) - r_1\cos(\theta_1) - r_4\cos(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))))  \\
0 \\
1 \\
\end{array}\right)\]

\[\frac{\partial\tilde{S}_x}{\partial(\theta_2)_j}=h_y(r_2\cos((\theta_2)_j) - 2r_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}({-0.5}(-4r_1r_2\cos((\theta_2)_j)^2\cos(\theta_1)\sin(\theta_1) + 4r_1r_2\sin((\theta_2)_j)^2\cos(\theta_1)\sin(\theta_1))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) - 2r_2r_4(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))\cos((\theta_2)_j) + 2r_2r_4(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))\sin((\theta_2)_j)) + 2r_2r_4\cos((\theta_2)_j)) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))(2r_2r_4\sin((\theta_2)_j) - 2r_1r_2\sin((\theta_2)_j)^2\cos(\theta_1)\sin(\theta_1) + 2r_1r_2\cos((\theta_2)_j)^2\cos(\theta_1)\sin(\theta_1)))\cos(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))))) - r_2(1 - h_x)\sin((\theta_2)_j) - 2h_xr_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}({-0.5}(-4r_1r_2\cos((\theta_2)_j)^2\cos(\theta_1)\sin(\theta_1) + 4r_1r_2\sin((\theta_2)_j)^2\cos(\theta_1)\sin(\theta_1))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) - 2r_2r_4(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))\cos((\theta_2)_j) + 2r_2r_4(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))\sin((\theta_2)_j)) + 2r_2r_4\cos((\theta_2)_j)) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))(2r_2r_4\sin((\theta_2)_j) - 2r_1r_2\sin((\theta_2)_j)^2\cos(\theta_1)\sin(\theta_1) + 2r_1r_2\cos((\theta_2)_j)^2\cos(\theta_1)\sin(\theta_1)))\sin(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))))\]

\[\frac{\partial\tilde{S}_y}{\partial(\theta_2)_j}=h_y(-r_2\sin((\theta_2)_j) + 2r_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}({-0.5}(-4r_1r_2\cos((\theta_2)_j)^2\cos(\theta_1)\sin(\theta_1) + 4r_1r_2\sin((\theta_2)_j)^2\cos(\theta_1)\sin(\theta_1))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) - 2r_2r_4(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))\cos((\theta_2)_j) + 2r_2r_4(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))\sin((\theta_2)_j)) + 2r_2r_4\cos((\theta_2)_j)) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))(2r_2r_4\sin((\theta_2)_j) - 2r_1r_2\sin((\theta_2)_j)^2\cos(\theta_1)\sin(\theta_1) + 2r_1r_2\cos((\theta_2)_j)^2\cos(\theta_1)\sin(\theta_1)))\sin(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))))) + r_2(1 - h_x)\cos((\theta_2)_j) + 2h_xr_4/(1 + (\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))^2(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2))(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{-0.5}({-0.5}(-4r_1r_2\cos((\theta_2)_j)^2\cos(\theta_1)\sin(\theta_1) + 4r_1r_2\sin((\theta_2)_j)^2\cos(\theta_1)\sin(\theta_1))(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j)) - 2r_2r_4(-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))\cos((\theta_2)_j) + 2r_2r_4(-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))\sin((\theta_2)_j)) + 2r_2r_4\cos((\theta_2)_j)) + (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^(-2)(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))(2r_2r_4\sin((\theta_2)_j) - 2r_1r_2\sin((\theta_2)_j)^2\cos(\theta_1)\sin(\theta_1) + 2r_1r_2\cos((\theta_2)_j)^2\cos(\theta_1)\sin(\theta_1)))\cos(2\tan^{-1}(1/(r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_4\cos(\theta_1) + 2r_2r_4\cos((\theta_2)_j) - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))(\sigma((-2r_2r_4\cos((\theta_2)_j) + 2r_1r_4\cos(\theta_1))^2 + (-2r_2r_4\sin((\theta_2)_j) + 2r_1r_4\sin(\theta_1))^2 - (r_1^2 + r_2^2 + r_4^2 - r_3^2 - 2r_1r_2\cos(\theta_1)\cos((\theta_2)_j)\sin(\theta_1)\sin((\theta_2)_j))^2)^{0.5} - 2r_1r_4\sin(\theta_1) + 2r_2r_4\sin((\theta_2)_j))))\]

\end{document}
